#### Вопрос 06

##### D-ичная последовательность Хаффмана

(прим. Это только мое предположение, но похоже, что спрашивается алгоритм Хаффмана для $D\geq 2$)

*1-й этап - слияние.* Пусть задан алфавит $A = \{a_1, \dots, a_m\}$ с распределением вероятностей $\vec{p} = (p_1, \dots, p_m)$, причем $p_1\geq p_2\geq\dots\geq p_m$. 

Если $m=D$, то переходим ко второму этапу.

Если $m>D$ выполняем *слияние* наименее вероятных $s$ символов:

$A\rightarrow A^{(1)} = \{a_1,\dots,a_{m-s},\sigma\},$

$\vec{p}\rightarrow\vec{p}^{(1)} = (p_1,\dots,p_{m-s},\gamma),$

где $\sigma = a_{m-s+1}\cup\dots\cup a_m, \gamma=p_{m-s+1}+\dots+p_m.$ Упорядочиваем символы алфавита $A^{(1)}$ в порядке невозрастания вероятностей распределения $\vec{p}^{(1)}$ и возвращаемся к началу первого этапа. 

(прим. Если вам непонятна написанная выше херобора, то я с вами полностью солидарен, поэтому объяснение на пальцах, let's go)

Подсчитываем параметр $m$ - количество кодовых слов в исходном алфавите. Найдем параметр $k$, такой что $m_0 = 1 + k(D-1)$ причем должно выполнятся условие $m_0\geq m$ с наименьшим превосходством. Затем находим параметр $S = m - m_0 + D$, поздравляем, вы нашли количество слияний на первом шаге, после этого все слияния будут размера $D$.

*2-й этап - кодирование.* Пусть на первом этапе алгоритма построена цепочка слияний. В качестве кодирования $\varphi_{k-1}:A^{(k-1)}\rightarrow B^*$ возьмем произвольное взаимно однозначное соответствие между алфавитами $A^{(k-1)}$ и $B$.

Предположим, что уже заданы кодирования $\varphi_{k-1}, \varphi_{k-2},\dots,\varphi_{i+1},$ и зададим кодирование $\varphi_i:A^{(i)}\rightarrow B^*$ следующим образом. Если алфавит $A^{(i+1)}$ был получен из алфавит $A^{(i+1)}$ был получен из алфавита $A^{(i)}$ слиянием некоторых $s$ символов $a_1',\dots,a_s'$ в один новый символ $\sigma'$, то кодирование $\varphi_i$ получается из кодирования $\varphi_{i+1}$ заменой одного равенства $\varphi_{i+1}(\sigma') = w\in B^*$ на $s$ равенств $\varphi_i(a_j') = wb_j, 1\leq j\leq s.$

Второй этап алгоритма завершается построением искомого кодирования $\varphi=\varphi_0$.